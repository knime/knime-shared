# This is the OpenAPI spec, describing the KNIME gateway.
openapi: 3.0.0
info:
  title: KNIME Gateway API
  version: 1.0.0
  description: Gateway operations on KNIME workflows.


# E.g. gateway-service interfaces are created from the tags, such as WorkflowService or NodeService
tags:
  - name: Workflow
    description: Operations on workflows.
  - name: Node
    description: Operations on single nodes.
  - name: Annotation
    description: Operations on single workflow annotations.
  - name: WizardExecution
    description: Operations for the worklfow wizard execution.

paths:
  /workflow/{workflow-id}/parts:
    post:
      tags:
        - Workflow
      description: >-
        Selects and essentially copies the specified part of the workflow. It
        will still be available even if (sub)parts are deleted. The parts are
        referenced by a part-id.  Note: connections will be ignored and _not_
        copied!
      operationId: createWorkflowCopy
      parameters:
        - $ref: '#/components/parameters/job-id'
        # id of the workflow to create the copy from
        - $ref: "#/components/parameters/workflow-id"
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WorkflowParts'
        description: The actual part selection.
        required: true
      x-knime-gateway-executor-exceptions:
         #if the parent id of the parts to be copied doesn't refer to a sub-workflow
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NotASubWorkflow'
         #if the parent id of the parts to be copied doesn't refer to a node
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NodeNotFound'
         #if parts to be copied don't exist
         - $ref: '#/components/x-knime-gateway-executor-exceptions/InvalidRequest'
      responses:
        '201':
          description: Successfully created. Returns the parts-id.
          content:
            application/json:
              schema:
                type: string
                format: uuid
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: "#/components/responses/NoPermission"
        '500':
          $ref: "#/components/responses/InternalServerError"
        '504':
          $ref: "#/components/responses/Timeout"
    delete:
      tags:
        - Workflow
      description: >-
        Deletes the given workflow parts. Cannot be undone unless a copy has
        been made before.
      operationId: deleteWorkflowParts
      parameters:
        - $ref: '#/components/parameters/job-id'
        # id of the workflow to delete the parts from
        - $ref: "#/components/parameters/workflow-id"
        - name: copy
          in: query
          description: >-
            If a copy should be created before removal. False by default. Please
            note that the copy will _only_ include the connections that are
            entirely enclosed by the parts to be removed (i.e. connections that
            are connecting two removed nodes - all others won't be kept)
          required: false
          schema:
            type: boolean
            default: false
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WorkflowParts'
        description: The parts to be deleted.
        required: true
      x-knime-gateway-executor-exceptions:
         #if the parent id of the parts to be deleted doesn't refer to a sub-workflow
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NotASubWorkflow'
         #if the parent id of the parts to be deleted doesn't refer to a node
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NodeNotFound'
         #if a part exists but couldn't be removed
         - $ref: '#/components/x-knime-gateway-executor-exceptions/ActionNotAllowed'
      responses:
        '200':
          description: >-
            Parts have been deleted successfully. Parts that don't exist in the
            workflow will be ignored. If a copy has been chosen to be created,
            the respective part-id of the copy will be returned otherwise null.
          content:
            application/json:
              schema:
                type: string
                format: uuid
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: "#/components/responses/NoPermission"
        '500':
          $ref: "#/components/responses/InternalServerError"
        '504':
          $ref: "#/components/responses/Timeout"
          
  '/workflow/{workflow-id}/parts/{parts-id}':
    put:
      tags:
        - Workflow
      description: Pastes the referenced parts into the referenced (sub-)workflow.
      operationId: pasteWorkflowParts
      parameters:
        - $ref: '#/components/parameters/job-id'
        # id of the workflow to paste the parts into
        - $ref: "#/components/parameters/workflow-id"
        - name: parts-id
          in: path
          description: The id referencing the parts to paste.
          required: true
          schema:
            type: string
            format: uuid
        - name: x
          in: query
          description: The x position to paste the parts.
          required: true
          schema:
            type: integer
        - name: 'y'
          in: query
          description: The y position to paste the parts.
          required: true
          schema:
            type: integer
      x-knime-gateway-executor-exceptions:
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NotASubWorkflow'
         #if the parent id of the parts to be deleted doesn't refere to a node
         #OR: if there is no copy for the given part-id
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NotFound'
      responses:
        '200':
          description: >-
            Parts have been successfully pasted. Returns the pasted workflow
            parts.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkflowParts'
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: "#/components/responses/NoPermission"
        '500':
          $ref: "#/components/responses/InternalServerError"
        '504':
          $ref: "#/components/responses/Timeout"

  '/workflow/{workflow-id}':
    get:
      tags:
        - Workflow
      description: >-
        Retrieves the complete structure (nodes, connections, annotations) of
        (sub-)workflows.
      operationId: getWorkflow
      parameters:
        - $ref: '#/components/parameters/job-id'
        - $ref: "#/components/parameters/workflow-id"
      x-knime-gateway-executor-exceptions:
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NotASubWorkflow'
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NodeNotFound'
      responses:
        '200':
          description: 'Successful response, with a representation of the sub-workflow.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkflowSnapshot'
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: "#/components/responses/NoPermission"
        '500':
          $ref: "#/components/responses/InternalServerError"
        '504':
          $ref: "#/components/responses/Timeout"
    post:
      tags:
        - Node
      description: Creates and adds a new native node to the workflow.
      operationId: createNode
      parameters:
        - $ref: '#/components/parameters/job-id'
        # workflow-id of the workflow to add the new node to
        - $ref: "#/components/parameters/workflow-id"
        - name: x
          description: the x coordinate to place the new node
          in: query
          required: true
          schema:
            type: integer
        - name: 'y'
          description: the y coordinate to place the new node
          in: query
          required: true
          schema:
            type: integer
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NodeFactoryKey'
        description: The key representing the native node to be added to the workflow.
        required: true
      x-knime-gateway-executor-exceptions:
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NotASubWorkflow'
         # if the parent node couldn't be found or the node factory key is unknown
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NodeNotFound'
         # if the node factory key's settings are required but missing or not readable
         - $ref: '#/components/x-knime-gateway-executor-exceptions/InvalidRequest'
      responses:
        '201':
          description: New node has been successfully created. Returns the new node id.
          content:
            application/json:
              schema:
                type: string
                format: node-id
                pattern: '^root(:\d+)*$'
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: '#/components/responses/NoPermission'
        '504':
          $ref: '#/components/responses/Timeout'
        '505':
          $ref: '#/components/responses/InternalServerError'

  '/workflowdiff/{workflow-id}':
    get:
      tags:
        - Workflow
      description: Gives the changes of the sub-workflow as a patch.
      operationId: getWorkflowDiff
      parameters:
        - $ref: '#/components/parameters/job-id'
        - $ref: "#/components/parameters/workflow-id"
        - name: snapshot-id
          in: query
          description: The id of the workflow snapshot already retrieved.
          required: true
          schema:
            type: string
            format: uuid
      x-knime-gateway-executor-exceptions:
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NotASubWorkflow'
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NotFound'
      responses:
        '200':
          description: 'Successful response, with a patch containing all the changes.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Patch'
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: "#/components/responses/NoPermission"
        '500':
          $ref: "#/components/responses/InternalServerError"
        '504':
          $ref: "#/components/responses/Timeout"

  '/workflow/wmetanode/{node-id}/dialog':
    get:
      tags:
        - Node
      description: >-
        Gives access to the dialog representations, values and configs of a
        component.
      operationId: getWMetaNodeDialog
      parameters:
        - $ref: '#/components/parameters/job-id'
        - $ref: "#/components/parameters/node-id"
      x-knime-gateway-executor-exceptions:
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NodeNotFound'
         - $ref: '#/components/x-knime-gateway-executor-exceptions/InvalidRequest'
      responses:
        '200':
          description: Successful response with a representation of the metanode dialog.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MetaNodeDialog'
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: '#/components/responses/NoPermission'
        '504':
          $ref: '#/components/responses/Timeout'
        '505':
          $ref: '#/components/responses/InternalServerError'

  '/workflow/node/{node-id}':
    get:
      tags:
        - Node
      description: Retrieves the node for the given node-id.
      operationId: getNode
      parameters:
        - $ref: '#/components/parameters/job-id'
        - $ref: "#/components/parameters/node-id"
      x-knime-gateway-executor-exceptions:
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NodeNotFound'
      responses:
        '200':
          description: 'Successful response, with a representation of the Node.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Node'
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: '#/components/responses/NoPermission'
        '504':
          $ref: '#/components/responses/Timeout'
        '505':
          $ref: '#/components/responses/InternalServerError'

  '/workflow/node/{node-id}/bounds':
    put:
      tags:
        - Node
      description: Sets the node's bounds for the given node-id.
      operationId: setNodeBounds
      parameters:
        - $ref: '#/components/parameters/job-id'
        - $ref: "#/components/parameters/node-id"
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Bounds'
        description: The node bounds to set.
        required: true          
      x-knime-gateway-executor-exceptions:
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NodeNotFound'
      responses:
        '200':
          description: Settings successfully set.
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: '#/components/responses/NoPermission'
        '504':
          $ref: '#/components/responses/Timeout'
        '505':
          $ref: '#/components/responses/InternalServerError'

  '/workflow/node/{node-id}/settings':
    get:
      tags:
        - Node
      description: Retrieves the node's settings for the given node-id.
      operationId: getNodeSettings
      parameters:
        - $ref: '#/components/parameters/job-id'
        - $ref: "#/components/parameters/node-id"
      x-knime-gateway-executor-exceptions:
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NodeNotFound'
      responses:
        '200':
          description: 'Successful response, with a json-representation of the settings'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NodeSettings'
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: '#/components/responses/NoPermission'
        '504':
          $ref: '#/components/responses/Timeout'
        '505':
          $ref: '#/components/responses/InternalServerError'
    put:
      tags:
        - Node
      description: Sets the node's settings for the given node-id.
      operationId: setNodeSettings
      parameters:
        - $ref: '#/components/parameters/job-id'
        - $ref: "#/components/parameters/node-id"
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/NodeSettings'
        description: The node settings to set.          
      x-knime-gateway-executor-exceptions:
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NodeNotFound'
         - $ref: '#/components/x-knime-gateway-executor-exceptions/InvalidSettings'
         - $ref: '#/components/x-knime-gateway-executor-exceptions/IllegalState'
      responses:
        '200':
          description: Settings successfully set.
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: '#/components/responses/NoPermission'
        '504':
          $ref: '#/components/responses/Timeout'
        '505':
          $ref: '#/components/responses/InternalServerError'

  '/workflow/node/{node-id}/state':
    post:
      tags:
        - Node
      description: Retrieves and manipulates the node's state for the given node-id.
      operationId: changeAndGetNodeState
      parameters:
        - $ref: '#/components/parameters/job-id'
        - $ref: "#/components/parameters/node-id"
        - name: action
          description: >-
            The action (reset, cancel, execute) to be performed in order to
            change the node's state.
          in: query
          schema:
            type: string
            enum:
              - reset
              - cancel
              - execute
      x-knime-gateway-executor-exceptions:
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NodeNotFound'
         - $ref: '#/components/x-knime-gateway-executor-exceptions/ActionNotAllowed'
      responses:
        '200':
          description: 'Successful response, with the current node''s state.'
          content:
            application/json:
              schema:
                type: string
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: '#/components/responses/NoPermission'
        '504':
          $ref: '#/components/responses/Timeout'
        '505':
          $ref: '#/components/responses/InternalServerError'

  '/workflow/node/{node-id}/output/specs':
    get:
      tags:
        - Node
      description: Provides the node's output port specifications for the given node-id.
      operationId: getOutputPortSpecs
      parameters:
        - $ref: '#/components/parameters/job-id'
        - $ref: "#/components/parameters/node-id"
      x-knime-gateway-executor-exceptions:
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NodeNotFound'
      responses:
        '200':
          description: >-
            Successful response, with a list of json-representations of the port
            object specs.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PortObjectSpec'
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: '#/components/responses/NoPermission'
        '504':
          $ref: '#/components/responses/Timeout'
        '505':
          $ref: '#/components/responses/InternalServerError'

  '/workflow/node/{node-id}/output/{port-idx}/table':
    get:
      tags:
        - Node
      description: >-
        Gives access to the table at the a certain port index (if it's a table).
        Otherwise will return 'not supported'.
      operationId: getOutputDataTable
      parameters:
        - $ref: '#/components/parameters/job-id'
        - $ref: "#/components/parameters/node-id"
        - name: port-idx
          in: path
          description: The port index to get the table for.
          required: true
          schema:
            type: integer
        - name: from
          in: query
          description: >-
            Row index to start returning the rows. Rows from the beginning (i.e.
            index 0) will be returned.
          required: false
          schema:
            type: integer
            format: int64
        - name: size
          in: query
          description: >-
            Number of rows to retrieve. If not given, all rows to the end of the
            table are returned.
          required: false
          schema:
            type: integer
      x-knime-gateway-executor-exceptions:
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NodeNotFound'
         - $ref: '#/components/x-knime-gateway-executor-exceptions/InvalidRequest'
      responses:
        '200':
          description: 'Successful response, with the specified range of rows.'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DataTable'
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: '#/components/responses/NoPermission'
        '504':
          $ref: '#/components/responses/Timeout'
        '505':
          $ref: '#/components/responses/InternalServerError'

  '/workflow/node/{node-id}/output/flowvariables':
    get:
      tags:
        - Node
      description: >-
        Provides the node's flow variables available for the node's output with
        the given node-id. For metanodes (not components) the same
        variables are returned as with '... For metanodes (not components)
        the same variables are returned as with
        '.../input/flowvariables'.
      operationId: getOutputFlowVariables
      parameters:
        - $ref: '#/components/parameters/job-id'
        - $ref: "#/components/parameters/node-id"
      x-knime-gateway-executor-exceptions:
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NodeNotFound'
      responses:
        '200':
          description: 'Successful response, with a all flow variables available'
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/FlowVariable'
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: '#/components/responses/NoPermission'
        '504':
          $ref: '#/components/responses/Timeout'
        '505':
          $ref: '#/components/responses/InternalServerError'

  '/workflow/node/{node-id}/input/specs':
    get:
      tags:
        - Node
      description: >-
        Provides the node's input port specifications for the given node-id.
        I.e. all output port specs of the output ports connected to the input
        ports of this node.
      operationId: getInputPortSpecs
      parameters:
        - $ref: '#/components/parameters/job-id'
        - $ref: "#/components/parameters/node-id"
      x-knime-gateway-executor-exceptions:
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NodeNotFound'
      responses:
        '200':
          description: >-
            Successful response, with a list of json-representations of the port
            object specs.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PortObjectSpec'
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: '#/components/responses/NoPermission'
        '504':
          $ref: '#/components/responses/Timeout'
        '505':
          $ref: '#/components/responses/InternalServerError'

  '/workflow/node/{node-id}/input/flowvariables':
    get:
      tags:
        - Node
      description: >-
        Provides the node's flow variables available for the node with the given
        node-id.
      operationId: getInputFlowVariables
      parameters:
        - $ref: '#/components/parameters/job-id'
        - $ref: "#/components/parameters/node-id"
      x-knime-gateway-executor-exceptions:
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NodeNotFound'
      responses:
        '200':
          description: 'Successful response, with a list of all flow variables available'
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/FlowVariable'
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: '#/components/responses/NoPermission'
        '504':
          $ref: '#/components/responses/Timeout'
        '505':
          $ref: '#/components/responses/InternalServerError'

  '/workflow/node/{node-id}/view/data':
    get:
      tags:
        - Node
      description: >-
        Provides the data for the node's view, if the node supports views. The
        data includes the view's and the representation.
      operationId: getViewData
      parameters:
        - $ref: '#/components/parameters/job-id'
        - $ref: "#/components/parameters/node-id"
      x-knime-gateway-executor-exceptions:
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NodeNotFound'
         - $ref: '#/components/x-knime-gateway-executor-exceptions/InvalidRequest'
      responses:
        '200':
          description: Successful response with requested the web view.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ViewData'
        '400':
          $ref: "#/components/responses/GatewayExecutorException"
        '403':
          $ref: '#/components/responses/NoPermission'
        '504':
          $ref: '#/components/responses/Timeout'
        '505':
          $ref: '#/components/responses/InternalServerError'

  '/workflow/node/{node-id}/view/data/value':
    put:
      tags:
        - Node
      description: Saves back the view's value (e.g. title etc.) to the server.
      operationId: setViewValue
      parameters:
        - $ref: '#/components/parameters/job-id'
        - $ref: "#/components/parameters/node-id"
        - name: use-as-default
          in: query
          description: True if node settings are to be updated by view content.
          schema:
            type: boolean
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/JavaObject'
        description: The view value to set.          
      x-knime-gateway-executor-exceptions:
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NodeNotFound'
         - $ref: '#/components/x-knime-gateway-executor-exceptions/InvalidRequest'
      responses:
        '200':
          description: The new view value has been set successfully.
        '400':
          $ref: "#/components/responses/GatewayExecutorException"
        '403':
          $ref: '#/components/responses/NoPermission'
        '504':
          $ref: '#/components/responses/Timeout'
        '505':
          $ref: '#/components/responses/InternalServerError'

  /workflow/connection:
    post:
      tags:
        - Workflow
      description: >-
        Creates a new connection between two nodes. Note: replaces/removes
        existing connections if destination port is already in use.
      operationId: createConnection
      parameters:
        - $ref: '#/components/parameters/job-id'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Connection'
        description: The connection.
        required: true          
      x-knime-gateway-executor-exceptions:
         #if connection couldn't be added, e.g. because node is executing or a node for a given node id doesn't exist
         - $ref: '#/components/x-knime-gateway-executor-exceptions/ActionNotAllowed'
      responses:
        '201':
          description: Connection has been created.
          content:
            application/json:
              schema:
                description: >-
                  The connection id. Connection is identified by its destination
                  node id and destination port index and built as
                  '<dest-node-id>_<dest-ports-index>'
                type: string
                format: connection-id
                pattern: '^root(:\d+)*_\d+$'
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: '#/components/responses/NoPermission'
        '504':
          $ref: '#/components/responses/Timeout'
        '505':
          $ref: '#/components/responses/InternalServerError'

  '/workflow/annotation/{anno-id}/bounds':
    put:
      tags:
        - Annotation
      description: >-
        Changes the bounds (x,y,width,height) of a workflow annotation in a
        sub-workflow.
      operationId: setAnnotationBounds
      parameters:
        - $ref: '#/components/parameters/job-id'
        - name: anno-id
          in: path
          required: true
          schema:
            type: string
            format: annotation-id
            pattern: '^root(:\d+)*_\d+$'
          x-knime-gateway-server-param-as-string: true
      requestBody:
        $ref: '#/components/requestBodies/Bounds'          
      x-knime-gateway-executor-exceptions:
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NotASubWorkflow'
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NotFound'
      responses:
        '200':
          description: Bounds successfully changed
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: '#/components/responses/NoPermission'
        '504':
          $ref: '#/components/responses/Timeout'
        '505':
          $ref: '#/components/responses/InternalServerError'

  '/workflow/wizard/current-page':
    get:
      tags:
        - WizardExecution
      description: >-
        Returns the output for a workflow's current page. This is identical to the response returned by executing a workflow to the
        next page however it can be retrieved again at a later time. 
      operationId: getCurrentPage
      parameters:
        - $ref: '#/components/parameters/job-id'
      responses:
        '200':
          description: Successful response with the current page content.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WizardPage"
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: '#/components/responses/NoPermission'
        '504':
          $ref: '#/components/responses/Timeout'
        '505':
          $ref: '#/components/responses/InternalServerError'
          
  '/workflow/wizard/next-page':
    post:
      tags:
        - WizardExecution
      description: >-
        Executes the workflow to the next page. If no data is sent the job is executed with the current view values (if
        there are any), otherwise the view values are set according to the JSON map provided.
      operationId: executeToNextPage
      parameters:
        - $ref: '#/components/parameters/job-id'
        - name: async
          description: >-
            If true the call will return immediately after input validation and starting the
            execution.
            If false the call will wait until execution has finished (which is the
            default if no request parameter is specified)
          in: query
          schema:
            type: boolean
            default: false
        - name: timeout
          description: >-
            Timeout in milliseconds when synchronous execution is requested. The request will return with a
            timeout-response if the workflow doesn't finish execution (step) before the timeout
          in: query
          schema:
            type: integer
            format: int64
            default: 600000
      requestBody:
        description: The input parameters for the next wizard page.
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/WizardPageInput"
      x-knime-gateway-executor-exceptions:
        - $ref: '#/components/x-knime-gateway-executor-exceptions/InvalidSettings'
        - $ref: '#/components/x-knime-gateway-executor-exceptions/NoWizardPage'
        - $ref: '#/components/x-knime-gateway-executor-exceptions/Timeout'
      x-knime-gateway-executor-exception-to-server-response-map:
        - executor-exception: InvalidSettingsException
          server-response: '406'
      responses:
        '200':
          description: Successful response with the next page's content if async is false. Otherwise an empty response.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WizardPage"
        '400':
          $ref: "#/components/responses/GatewayExecutorException"
        '406':
          $ref: "#/components/responses/ValidationError"
        '403':
          $ref: '#/components/responses/NoPermission'
        '504':
          $ref: '#/components/responses/Timeout'
        '505':
          $ref: '#/components/responses/InternalServerError'

  '/workflow/wizard/previous-page':
    post:
      tags:
        - WizardExecution
      description: >-
        Resets a workflow to a previously executed page.
      operationId: resetToPreviousPage
      parameters:
        - $ref: '#/components/parameters/job-id'
      x-knime-gateway-executor-exceptions:
        - $ref: '#/components/x-knime-gateway-executor-exceptions/NoWizardPage'
      responses:
        '200':
          description: Successful response with the previous page's content.
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/WizardPage"
        '400':
          $ref: "#/components/responses/GatewayExecutorException"
        '403':
          $ref: '#/components/responses/NoPermission'
        '504':
          $ref: '#/components/responses/Timeout'
        '505':
          $ref: '#/components/responses/InternalServerError'
          
  '/workflow/wizard/execution-statistics':
    get:
      tags:
        - WizardExecution
      description: Provides statistics on the node execution between wizard pages. 
      operationId: getExecutionStatistics
      parameters:
        - $ref: '#/components/parameters/job-id'
      x-knime-gateway-executor-exceptions:
         - $ref: '#/components/x-knime-gateway-executor-exceptions/NotFound'
      responses:
        '200':
          description: 'Successful response with the execution statistics since the last page or last call (if snapshot id is provided).'
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ExecutionStatistics"
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: "#/components/responses/NoPermission"
        '500':
          $ref: "#/components/responses/InternalServerError"
        '504':
          $ref: "#/components/responses/Timeout"
          
  '/workflow/wizard/web-resources':
    get:
      tags:
        - WizardExecution
      description: >-
        Returns a list of web resources needed for this job to handle wizard execution.
      operationId: listWebResources
      parameters:
        - $ref: '#/components/parameters/job-id'
      responses:
        '200':
          description: Successful response with a list of the web-resources.
          content:
            application/json:
              schema:
                type: array
                items:
                  type: string
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: '#/components/responses/NoPermission'
        '504':
          $ref: '#/components/responses/Timeout'
        '505':
          $ref: '#/components/responses/InternalServerError'

  '/workflow/wizard/web-resources/{resource-id:[^:]*}':
    get:
      tags:
        - WizardExecution
      description: >-
        Returns a list of web resources needed for this job to handle wizard execution.
      operationId: getWebResource
      parameters:
        - $ref: '#/components/parameters/job-id'
        - name: resource-id
          description: The id (usually a relative path) of a single web resource (e.g. js, css, png, ...).
          in: path
          required: true
          schema:
            type: string
      x-knime-gateway-executor-exceptions:
        - $ref: '#/components/x-knime-gateway-executor-exceptions/NotFound'
      responses:
        '200':
          description: Response with the web-resource.
          content:
            # media type will be guessed and replaced by the framework based
            # on the file type requested (in the request path)
            '*/*':
              schema:
                type: string
                #NOTE: static binary responses will have the Last-Modified header set
                # -> 304 (not modified) will be returned if the precondition is true!
                format: binary
                x-knime-gateway-static-response: true
        '304':
          $ref: "#/components/responses/NotModified" 
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: '#/components/responses/NoPermission'
        '504':
          $ref: '#/components/responses/Timeout'
        '505':
          $ref: '#/components/responses/InternalServerError'

  '/workflow/wizard/report':
    get:
      tags:
        - WizardExecution
      description: >-
        Renders the report of an executed workflow into a certain format. 
      operationId: renderReport
      parameters:
        - $ref: '#/components/parameters/job-id'
        - name: format
          description: the requested report format
          in: query
          required: true
          schema:
            type: string
            default: 'PDF'
      x-knime-gateway-executor-exceptions:
        - $ref: '#/components/x-knime-gateway-executor-exceptions/Timeout'
        # if the workflow does not have a report or is not executed
        - $ref: '#/components/x-knime-gateway-executor-exceptions/InvalidRequest'
      responses:
        '200':
          description: The rendered report.
          content:
            '*/*':
              schema:
                type: string
                #NOTE: binary responses will have the Last-Modified header set
                # -> 304 (not modified) will be returned if the precondition is true!
                format: binary
        '400':
          $ref: '#/components/responses/GatewayExecutorException'
        '403':
          $ref: '#/components/responses/NoPermission'
        '504':
          $ref: '#/components/responses/Timeout'
        '505':
          $ref: '#/components/responses/InternalServerError'
                  
servers:
  - url: '/v4/jobs/{job-id}'
    variables:
      job-id:
        default: "{job-id}"

components:
  parameters:
    job-id:
      name: job-id
      in: path
      description: ID of the job the workflow is requested for.
      required: true
      schema:
        type: string
        format: uuid
    node-id:
      name: node-id
      in: path
      description: >-
        The ID of a node.
        The node-id format: Node IDs always start with 'root' and
        optionally followed by numbers separated by ':' refering to
        nested nodes/subworkflows,e.g. root:3:6:4.
        Nodes within components require an additional
        trailing '0', e.g. 'root:3:6:0:4' (if 'root:3:6' is a component).
      required: true
      schema:
        type: string
        format: node-id
        pattern: '^root(:\d+)*$'
      example: 'root:3:6:0:4'
      x-knime-gateway-server-param-as-string: true
    workflow-id:
      name: workflow-id
      in: path
      description: >-
        The ID of a worklow which has the same format as a node-id.
      required: true
      schema:
        type: string
        format: node-id
        pattern: '^root(:\d+)*$'
      example: 'root:3:6:0:4'
      x-knime-gateway-server-param-as-string: true
 
  x-knime-gateway-executor-exceptions:
    NodeNotFound:
      description: The requested node was not found.
      name: NodeNotFoundException
    NotFound:
      description: A resource couldn't be found.
      # more general not found exception (as opposed to the NodeNotFound exception)
      # - the actual cause can be found in the exception message 
      name: NotFoundException
    NotASubWorkflow:
      description: >-
        The requested node is not a sub-workflow (i.e. a meta- or sub-node), but
        is required to be.
      name: NotASubWorkflowException
    ActionNotAllowed:
      description: >-
        If the an action is not allowed because it's not applicable or it
        doesn't exist.
      # TODO maybe rename to 'OperationNotAllowed'
      name: ActionNotAllowedException
    InvalidRequest:
      description: If the request is invalid for a reason.
      name: InvalidRequestException 
    InvalidSettings:
      description: If settings couldn't be applied.
      name: InvalidSettingsException
    IllegalState:
      description: If node is not in the right state to apply the settings.
      name: IllegalStateException
    NoWizardPage:
      description: If a wizard page is not available.
      name: NoWizardPageException
    Timeout:
      description: If the executor got a timeout, e.g., because a workflow
        didn't finish execution before the timeout.
      name: TimeoutException
     
  
  # Some notes on responses and code-generation:
  # In the generated java-code responses (except 200 and 201 responses) are (optionally) mapped to one or more exceptions
  # that are thrown respectively.
  # The expected exceptions for a response are defined by the response's 'x-knime-gateway-server-exceptions'-extension (see below).
  # A fully qualified class name must be specified ('fullname'-property).
  # The specified exceptions will, e.g., be added as thrown exceptions in the method signature of the server side endpoint definitions.
  # 
  # The exceptions specified here are only thrown by/in the server and returned as response.
  # Exceptions thrown by/in the executor (see above) are defined and handled differently.
  responses:
    # server responses
    InternalServerError:
      description: >-
        Internal server error, e.g. if an error occurs while fetching job
        information from the RMI.
      x-knime-gateway-server-exceptions:
        - fullname: com.knime.enterprise.utility.ExecutorException
          description: if an error occurs while fetching job information from the RMI instance
        - fullname: java.io.IOException
          description: IO error
    Timeout:
      description: When time to contact the executor has been exceeded.
      x-knime-gateway-server-exceptions:
        - fullname: java.util.concurrent.TimeoutException
    NoPermission:
      description: If the current user does not have access permissions for the job.
      x-knime-gateway-server-exceptions:
        - fullname: com.knime.enterprise.utility.PermissionException
    NotModified:
      description: If a requested resource hasn't been modified (in case of conditional requests). 
        
    # server responses without exceptions defined
    GatewayExecutorException:
      description: >-
        Response returned when a gateway service threw an exception in the executor.
        The exception is one of the executor-exceptions listed above.
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/GatewayException"
    ValidationError:
      description: >-
        Server response returned when wizard page validation failed on the next-page call.
      content:
        application/json:
          schema:
            type: string
  

  requestBodies:
    Bounds:
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Bounds'
      required: true

# A comment on object/schema/model inheritance: polymorphism/subtyping in swagger is achieved by the 'allOf'-property
# and the specification of a 'dicriminator'-property to be able to tell them apart (see, e.g., Node).
# However, in Swagger 2.0 it has it's issues and it has been improved in OpenAPI 3.0 (introducing a mapping of
# discriminator-values to the respective schemas). Here, one could at least set the 'discriminator'-property
# to "read-only" and provide the respective default values in the spec already.
# But I chose to not clutter the API-spec too much at the expense of few actually unnecessary method calls within the
# generated java-code (the 'discriminator'-property has to be explicitly set every time an object is created).
  schemas:
    Annotation:
      description: A text annotation.
      type: object
      discriminator:
        propertyName: type
      required:
        - type
      properties:
        type:
          description: >-
            Discriminator for inheritance. Must be the base name of this
            type/schema.
          type: string
        text:
          type: string
        backgroundColor:
          type: integer
        bounds:
          $ref: '#/components/schemas/Bounds'
        textAlignment:
          type: string
        borderSize:
          type: integer
        borderColor:
          type: integer
        defaultFontSize:
          type: integer
        version:
          type: integer
        styleRanges:
          description: Defines ranges of different styles within the annotation.
          type: array
          items:
            $ref: '#/components/schemas/StyleRange'

    Bounds:
      description: Node dimensions - position and size.
      type: object
      required:
        - x
        - 'y'
        - width
        - height
      properties:
        x:
          type: integer
        'y':
          type: integer
        width:
          type: integer
        height:
          type: integer
      x-knimegateway-isUsedAsParameter: true

    Connection:
      description: A single connection between two nodes.
      type: object
      required:
        - dest
        - destPort
        - source
        - sourcePort
        - type
      properties:
        dest:
          description: >-
            The destination node.
            The node-id format: Node IDs always start with 'root' and
            optionally followed by numbers separated by ':' refering to
            nested nodes/subworkflows,e.g. root:3:6:4.
            Nodes within components require an additional
            trailing '0', e.g. 'root:3:6:0:4' (if 'root:3:6' is a component).
          type: string
          format: node-id
          pattern: '^root(:\d+)*$'
        destPort:
          type: integer
          description: 'The destination port, starting at 0.'
        source:
          description: >-
            The source node.
            The node-id format: Node IDs always start with 'root' and
            optionally followed by numbers separated by ':' refering to
            nested nodes/subworkflows,e.g. root:3:6:4.
            Nodes within components require an additional
            trailing '0', e.g. 'root:3:6:0:4' (if 'root:3:6' is a component).
          type: string
          format: node-id
          pattern: '^root(:\d+)*$'
        sourcePort:
          type: integer
          description: 'The source port, starting at 0.'
        deletable:
          type: boolean
          description: Whether the connection can currently be deleted.
        flowVariablePortConnection:
          type: boolean
          description: Whether it's a connection between two flow variable ports.
        bendPoints:
          type: array
          items:
            $ref: '#/components/schemas/XY'
        type:
          type: string
          enum:
            - STD
            - WFMIN
            - WFMOUT
            - WFMTHROUGH
          description: >-
            The type of the connection (standard, workflow input / output
            /through).
      x-knimegateway-isUsedAsParameter: true

    DataCell:
      description: A cell of a data table.
      type: object
      properties:
        type:
          description: >-
            The type of the data cell represented by the implementing java-class
            name. If not given, it is assumed that the type can be infered from
            the data table spec.
          type: string
        valueAsString:
          description: The cell value as a string.
          type: string
        missing:
          description: >-
            If it's a missing cell - The error message is passed via the
            'valueAsString'-prop.
          type: boolean
        binary:
          description: >-
            Whether the 'valueAsString'-prop contains a serialized binary
            string, that is base64-encoded.
          type: boolean
        problem:
          description: >-
            Indicates whether there was a problem creating this cell. The
            details are given via the 'valueAsString'-prop.
          type: boolean

    DataRow:
      description: A data row.
      type: object
      properties:
        rowID:
          description: The row id.
          type: string
        columns:
          description: The column list.
          type: array
          items:
            $ref: '#/components/schemas/DataCell'

    DataTable:
      description: A data table. Might not contain all rows but only a chunk of rows.
      type: object
      properties:
        columnNames:
          description: The column names.
          type: array
          items:
            type: string
        numTotalRows:
          description: >-
            The total number of rows. Might be larger than the number of rows
            contained here. If a value < 0 indicates that the row count is not know.
          type: integer
          format: int64
        rows:
          description: The actual rows.
          type: array
          items:
            $ref: '#/components/schemas/DataRow'

    MetaNodeDialog:
      description: A representation of a metanode dialog.
      type: object
      properties:
        components:
          description: List of contributing dialog components.
          type: array
          items:
            $ref: '#/components/schemas/MetaNodeDialogComp'

    MetaNodeDialogComp:
      description: A component that is part of a metanode dialog.
      type: object
      properties:
        paramName:
          description: Parameter name for external parametrization.
          type: string
        nodeID:
          description: The id of the node contributing to this dialog.
          type: string
          format: node-id
          pattern: '^root(:\d+)*$'
        isHideInDialog:
          description: Whether the component should be hidden in the subnode's dialog.
          type: boolean
        representation:
          #Dialog component representation.
          $ref: '#/components/schemas/JavaObject'
          
    FlowVariable:
      description: >-
        Local variable of basic type which is passed along connections in a
        workflow.
      type: object
      properties:
        name:
          description: The flow variable's name.
          type: string
        type:
          description: The flow variables's type.
          type: string
          enum:
            - DOUBLE
            - INTEGER
            - STRING
        value:
          description: The actual value.
          type: string
    
    GatewayException:
      description: Details of an exception thrown by gateway implementations such as services.
      type: object 
      properties:
        exception-name:
          description: Simple name of the gateway executor exception.
          type: string
        exception-message:
          description: The more detailed exception message.
          type: string

    JavaObject:
      description: A java object/class that can be deserialized from a string.
      type: object
      properties:
        classname:
          description: The fully qualified class name of the java object.
          type: string
        jsonContent:
          description: The actual content as a (json) string.
          type: string
      x-knimegateway-isUsedAsParameter: true

    JobManager:
      description: node's job manager
      type: object
      required:
        - id
      properties:
        id:
          type: string

    MetaPortInfo:
      description: The port of a metanode.
      type: object
      required:
        - portType
      properties:
        portType:
          #The type.
          $ref: '#/components/schemas/PortType'
        connected:
          description: Whether it is connected.
          type: boolean
        message:
          description: The message (summary of upstream node port).
          type: string
        oldIndex:
          description: The old index.
          type: integer
        newIndex:
          description: The new index.
          type: integer

    NativeNode:
      description: Native node extension of a node.
      #inheritance
      allOf:
        - $ref: '#/components/schemas/Node'
        - type: object
          required:
            - nodeFactoryKey
          properties:
            nodeFactoryKey:
              #The key/ID of the node factory defining all details.
              $ref: '#/components/schemas/NodeFactoryKey'
            inactive:
              description: 'Whether this node is inactive, e.g. due to inactive connections'
              type: boolean

    NodeAnnotation:
      description: The annotation to a node.
      allOf:
        - $ref: '#/components/schemas/Annotation'
        - type: object
          properties:
            default:
              description: Default node annotation.
              type: boolean

    Node:
      description: A node.
      type: object
      required:
        - name
        - nodeID
        - nodeType
        - nodeState
        - type
        - rootWorkflowID
      discriminator:
        propertyName: type
      properties:
        type:
          type: string
          description: >-
            Discriminator for inheritance. Must be the base name of this
            type/schema.
        name:
          description: The node's name.
          type: string
        nodeID:
          description: The ID of the node.
          type: string
          format: node-id
          pattern: '^root(:\d+)*$'
        nodeType:
          description: The type of the node.
          type: string
          enum:
            - Source
            - Sink
            - Learner
            - Predictor
            - Manipulator
            - Visualizer
            - Meta
            - LoopStart
            - LoopEnd
            - ScopeStart
            - ScopeEnd
            - QuickForm
            - Other
            - Missing
            - Unknown
            - Subnode
            - VirtualIn
            - VirtualOut
        parentNodeID:
          description: >-
            The parent node id of the node or "root" if it's the root
            node/workflow.
          type: string
          format: node-id
          pattern: '^root(:\d+)*$'
        rootWorkflowID:
          description: The id of the root workflow this node is contained in or represents.
          type: string
          format: uuid
        nodeMessage:
          # 'The current node message (warning, error, none).'
          $ref: '#/components/schemas/NodeMessage'
        nodeState:
          # The state of the node.
          $ref: '#/components/schemas/NodeState'
        progress:
          # The node's progress.
          $ref: '#/components/schemas/NodeProgress'
        inPorts:
          description: The list of inputs.
          type: array
          items:
            $ref: '#/components/schemas/NodeInPort'
        outPorts:
          description: The list of outputs.
          type: array
          items:
            $ref: '#/components/schemas/NodeOutPort'
        deletable:
          description: Whether the node is deletable.
          type: boolean
          default: false
        resetable:
          description: >-
            Whether the node is resetable. Please note that it only represents
            the 'local' reset-state but doesn't take the whole workflow into
            account (e.g. executing successors).
          type: boolean
          default: false
        hasDialog:
          description: Whether the node has a configuration dialog / user settings.
          type: boolean
        nodeAnnotation:
          # The annotation below the node.
          $ref: '#/components/schemas/NodeAnnotation'
        webViewNames:
          description: The names of the available web views. Can be an empty list.
          type: array
          items:
            type: string
        jobManager:
          # The job manager (e.g. cluster or streaming).
          $ref: '#/components/schemas/JobManager'
        uIInfo:
          $ref: '#/components/schemas/NodeUIInfo'

    NodeFactoryKey:
      description: Object to identify a node-specific node implementation.
      type: object
      required:
        - className
      properties:
        className:
          description: The fully qualified java classname.
          type: string
        settings:
          description: >-
            Additional settings in order to be able to re-create nodes. Only
            required in case of 'dynamic' node factories.
          type: string

    NodeInPort:
      description: An input port of a node.
      allOf:
        - $ref: '#/components/schemas/NodePort'

    NodeMessage:
      description: node message
      type: object
      required:
        - message
      properties:
        type:
          type: string
        message:
          type: string

    NodeOutPort:
      description: The output port of a node.
      allOf:
        - $ref: '#/components/schemas/NodePort'
        - type: object
          properties:
            summary:
              description: 'The port summary, e.g. num of rows and cols in case of a table.'
              type: string
            inactive:
              description: Determines whether the output is inactive.
              type: boolean

    NodePort:
      description: A single port of a node.
      type: object
      discriminator:
        propertyName: type
      required:
        - type
        - portIndex
        - portType
      properties:
        type:
          description: >-
            Discriminator for inheritance. Must be the base name of this
            type/schema.
          type: string
        portIndex:
          description: The index starting at 0.
          type: integer
        portType:
          # The type of the port.
          $ref: '#/components/schemas/PortType'
        portName:
          description: The name of the port.
          type: string

    NodeProgress:
      description: Represents the node's progress.
      type: object
      properties:
        progress:
          description: 'The actual progress, a value between 0 and 1.'
          type: number
        message:
          description: A progress message.
          type: string

    NodeState:
      type: object
      required:
        - state
      properties:
        state:
          type: string
          enum:
            - IDLE
            - CONFIGURED
            - UNCONFIGURED_MARKEDFOREXEC
            - CONFIGURED_MARKEDFOREXEC
            - EXECUTED_MARKEDFOREXEC
            - CONFIGURED_QUEUED
            - EXECUTED_QUEUED
            - PREEXECUTE
            - EXECUTING
            - EXECUTINGREMOTELY
            - POSTEXECUTE
            - EXECUTED

    NodeUIInfo:
      description: >-
        Essentially the position of a node including some flags indicating a
        necessary correction of that given position.
      type: object
      required:
        - bounds
      properties:
        bounds:
          # The absolute node coordinates.
          $ref: '#/components/schemas/Bounds'
        symbolRelative:
          type: boolean
          default: false
        dropLocation:
          type: boolean
          default: false
        snapToGrid:
          type: boolean
          default: false
      x-knimegateway-isUsedAsParameter: true

    Patch:
      description: A list of patch operations.
      type: object
      properties:
        ops:
          description: The operations that make up this patch.
          type: array
          items:
            $ref: '#/components/schemas/PatchOp'
        snapshotID:
          description: >-
            A unique identifier for the version of the object this patch is
            applied to. Should only be missing if the patch is empty!
          type: string
          format: uuid
        targetTypeID:
          description: >-
            ID of the entity this patch can exclusively be applied to. Should
            only be missing, if the patch is empty!
          type: string

    PatchOp:
      description: A JSONPatch document as defined by RFC 6902
      type: object
      required:
        - op
        - path
      properties:
        op:
          type: string
          description: The operation to be performed
          enum:
            - add
            - remove
            - replace
            - move
            - copy
            - test
        path:
          type: string
          description: A JSON-Pointer
        value:
          type: object
          description: The value to be used within the operations.
        from:
          type: string
          description: A string containing a JSON Pointer value.

    PortObjectSpec:
      description: Specification of a port object.
      type: object
      required:
        - className
        - portType
        - inactive
      properties:
        className:
          description: >-
            The fully-qualified class name of the port object spec. 
          type: string
        portType:
          # The port type the specification refers to.
          $ref: '#/components/schemas/PortType'
        representation:
          description: >-
            The actual port object spec representation or a description of the problem if 'problem' is true.
          type: string
        inactive:
          description: >-
            Flag indicating whether the port is inactive. If true, there will be
            no representation available.
          type: boolean
        problem:
          description: >-
            Flag that indicates that a problem occured while providing the port objects spec 
            (e.g. de-/serialization problem). The representation-field will contain more details.
          type: boolean

    PortType:
      description: The type of a port.
      type: object
      required:
        - portObjectClassName
        - optional
      properties:
        portObjectClassName:
          description: 'Port type class name (for coloring, connection checks).'
          type: string
        optional:
          description: 'Whether the port is optional, only applies to input ports.'
          type: boolean
    
    ExecutionStatistics:
      description: Statistics and progress on the workflow execution.
      type: object
      properties:
        totalExecutionDuration:
          description: Total time execution took or is still taking, in milliseconds.
          type: number 
        nodesExecuted:
          description: >
            Nodes executed since the last snapshot (or triggered execution).
            In the order of their end time.
          type: array
          items:
            $ref: "#/components/schemas/NodeExecutedStatistics"
        nodesExecuting:
          description: >
            Nodes currently executing.
            In the order of their start time.
          type: array
          items:
            $ref: "#/components/schemas/NodeExecutingStatistics"
        wizardExecutionState:
          description: >
            The wizard execution state.
          type: string
          enum:
            - INTERACTION_REQUIRED
            - EXECUTING
            - EXECUTION_FINISHED
            - EXECUTION_FAILED
            - UNDEFINED
     
    NodeExecutedStatistics:
      description: Details and statistics on a node already executed.
      type: object
      properties:
        name:
          type: string
        annotation:
          description: The node annotation if set.
          type: string
        nodeID:
          type: string   
        executionDuration:
          description: The time it took for the node to finish (ms).
          type: number
        runs:
          description: How often the node has been executed (>1 if node is in a loop)
          type: number
          
    NodeExecutingStatistics:
      description: Details and statistics on a node still in execution.
      type: object
      properties:
        name:
          type: string
        annotation:
          description: The node annotation if set.
          type: string
        nodeID:
          type: string
        executionDuration:
          description: The time the execution took so far (ms).
          type: number
        progress:
          type: number

    NodeSettings:
      description: Settings of a node.
      type: object
      properties:
        jsonContent:
          description: The actual settings as a json-string.
          type: string
      # marks entities that are also used as parameters
      # necessary for the code-generation to not generate all entities
      # but only the ones used as parameters (in server-projects)
      x-knimegateway-isUsedAsParameter: true

    ViewData:
      description: >-
        The data for a node's view encompasing the view representation and
        value.
      type: object
      properties:
        javascriptObjectID:
          description: The object id used in the javascript implementation of the view.
          type: string
        viewRepresentation:
          # The view representation.
          $ref: '#/components/schemas/JavaObject'
        viewValue:
          # The view value.
          $ref: '#/components/schemas/JavaObject'
        hideInWizard:
          description: >-
            Property set in the configuration dialog to the node to skip this
            node in the wizard execution.
          type: boolean

    StyleRange:
      description: Defines the style of a range (e.g. within a workflow annotation).
      type: object
      properties:
        start:
          description: Style range start.
          type: integer
        length:
          description: Style range length.
          type: integer
        fontName:
          description: Style range font name.
          type: string
        fontStyle:
          description: 'The font style, e.g. normal, bold or italic.'
          type: string
          enum:
            - normal
            - bold
            - italic
        fontSize:
          description: Style range font size.
          type: integer
        foregroundColor:
          description: Style range foreground color.
          type: integer
          
    WizardPage:
      description: >
        Wizard page as returned, e.g., by the next-page and current-page endpoints.
      type: object
      properties:
        wizardPageContent:
          description: >
            The actual page content as provided by a component.
            Page content is guaranteed to be not available if wizard execution state is 'executing', 'undefined' or 'execution_failed'.
          type: object
        wizardExecutionState:
          description: >
            The wizard execution state.
          type: string
          enum:
            - INTERACTION_REQUIRED
            - EXECUTING
            - EXECUTION_FINISHED
            - EXECUTION_FAILED
            - UNDEFINED
        nodeMessages:
          description: The node (name and id) to node message map. Only available if workflow execution finished or failed.
          type: object
          additionalProperties:
            $ref: '#/components/schemas/NodeMessage'
        hasPreviousPage:
          description: Whether there is a previous page available or not.
          type: boolean
          
    WizardPageInput:
      description: Input data required to execute one wizard page of a workflow.
      type: object
      properties:
        viewValues:
          description: A map from node-ids to input parameters.
          additionalProperties:
            type: string
      x-knimegateway-isUsedAsParameter: true

    WorkflowAnnotation:
      description: A workflow annotation.
      allOf:
        - $ref: '#/components/schemas/Annotation'
        - type: object
          required:
            - annotationID
          properties:
            annotationID:
              description: Identifier for the workflow annotations.
              type: string
              format: annotation-id
              pattern: '^root(:\d+)*_\d+$'

    Workflow:
      type: object
      description: The structure of a workflow.
      properties:
        nodes:
          description: The node map.
          #string to Node map -> #TODO other way?
          type: object
          additionalProperties:
            $ref: '#/components/schemas/Node'
        connections:
          #string to Connectoin map
          description: The list of connections.
          type: object
          additionalProperties:
            $ref: '#/components/schemas/Connection'
        metaInPortInfos:
          description: The inputs of a metanode (if this workflow is one).
          type: array
          items:
            $ref: '#/components/schemas/MetaPortInfo'
        metaOutPortInfos:
          description: The outputs of a metanode (if this workflow is one).
          type: array
          items:
            $ref: '#/components/schemas/MetaPortInfo'
        workflowAnnotations:
          description: >-
            List of all workflow annotations. TODO could be moved to an extra UI
            service in order to not pollute the WorkflowEnt too much and separate
            UI logics.
          type: object
          #string to WorkflowAnnotation map
          additionalProperties:
            $ref: '#/components/schemas/WorkflowAnnotation'
        workflowUIInfo:
            # Additional workflow UI information such as grid settings, connection
            # appearance etc. TODO could be moved to an extra UI service in order
            # to not pollute the WorkflowEnt too much and separate UI logics.
          $ref: '#/components/schemas/WorkflowUIInfo'
        hasCredentials:
          description: Flag indicating whether the workflow has credentials stored.
          type: boolean
        inWizardExecution:
          description: >-
            If the workflow is executed step by step, i.e. in wizard execution
            mode.
          type: boolean

    WorkflowNode:
      description: >-
        A node containing (referencing) a workflow (also referred to it as
        metanode)
      allOf:
        - $ref: '#/components/schemas/Node'
        - type: object
          properties:
            workflowIncomingPorts:
              description: List of all incoming workflow ports.
              type: array
              items:
                $ref: '#/components/schemas/NodeOutPort'
            workflowOutgoingPorts:
              description: List of all outgoing workflow ports.
              type: array
              items:
                $ref: '#/components/schemas/NodeInPort'
            encrypted:
              description: >-
                Whether the referenced workflow is encrypted and is required to be
                unlocked before it can be accessed.
              type: boolean
            workflowOutgoingPortNodeStates:
              description: >-
                The state of the inner node connected to a particular outport.
                TODO Should actually be part of a specialization of NodeOutPort
                (i.e. WorkflowOutPort) but doesn't work with inheritance and
                generics in Java.
              type: array
              items:
                $ref: '#/components/schemas/NodeState'

    WorkflowParts:
      description: >-
        Represents a selection of parts of a workflow (i.e collections of nodes,
        connection, annotations etc.), e.g. to be copied or deleted.
      type: object
      properties:
        nodeIDs:
          description: The ids of the nodes referenced.
          type: array
          items:
            type: string
            format: node-id
            pattern: '^root(:\d+)*$'
        connectionIDs:
          description: >-
            The ids of the connections referenced. The id has the following
            format: <dest-node-id>_<dest-port-idx>
          type: array
          items:
            type: string
            format: connection-id
            pattern: '^root(:\d+)*_\d+$'
        annotationIDs:
          description: The ids of the workflow annotations referenced.
          type: array
          items:
            type: string
            format: annotation-id
            pattern: '^root(:\d+)*_\d+$'
      x-knimegateway-isUsedAsParameter: true

    WorkflowSnapshot:
      description: A workflow with an additional snapshot id.
      type: object
      required:
        - workflow
        - snapshotID
      properties:
        workflow:
          # The actual workflow.
          $ref: '#/components/schemas/Workflow'
        snapshotID:
          description: A unique identifier for the snapshot.
          type: string
          format: uuid

    WorkflowUIInfo:
      description: >-
        Contains workflow UI-related properties such as grid settings,
        connection appearance etc.
      type: object
      properties:
        gridX:
          description: Grid size in X direction.
          type: integer
        gridY:
          description: Grid size in Y direction.
          type: integer
        snapToGrid:
          description: Whether to snap to the grid.
          type: boolean
        showGrid:
          description: Whether to show the grid lines.
          type: boolean
        zoomLevel:
          description: 'Workflow zoom leve, i.e. its magnification.'
          type: number
        hasCurvedConnection:
          description: Whether connections are rendered as curves.
          type: boolean
        connectionLineWidth:
          description: Width of the line connecting two nodes.
          type: integer

    WrappedWorkflowNode:
      description: >-
        A node wrapping (referencing) a workflow (also referred to it as component
        or subnode) that almost behaves as a ordinary node.
      allOf:
        - $ref: '#/components/schemas/WorkflowNode'
        - type: object
          properties:
            virtualInNodeID:
              description: >
                Node ID of the virtual in-node (i.e. source).
                The node-id format: Node IDs always start with 'root' and
                optionally followed by numbers separated by ':' refering to
                nested nodes/subworkflows,e.g. root:3:6:4.
                Nodes within components require an additional
                trailing '0', e.g. 'root:3:6:0:4' (if 'root:3:6' is a component).
              type: string
              format: node-id
              pattern: '^root(:\d+)*$'
            virtualOutNodeID:
              description: >
                Node ID of the virtual out-node (i.e. sink).
                The node-id format: Node IDs always start with 'root' and
                optionally followed by numbers separated by ':' refering to
                nested nodes/subworkflows,e.g. root:3:6:4.
                Nodes within components require an additional
                trailing '0', e.g. 'root:3:6:0:4' (if 'root:3:6' is a component).
              type: string
              format: node-id
              pattern: '^root(:\d+)*$'
            inactive:
              description: 'Whether this node is inactive, e.g. due to inactive connections'
              type: boolean
            hasWizardPage:
              description: Whether the node has a wizard page (i.e. a composite web view)
              type: boolean

    XY:
      type: object
      description: XY coordinate
      properties:
        x:
          type: integer
        'y':
          type: integer
